<!DOCTYPE html>
<html>
<head>
    <link rel="icon" href="favicon.ico"/>
    <script src="javascript/phaser.min.js"></script>
</head>
<body>

    <script>
    var config = {
        type: Phaser.AUTO,
        width: 800,
        height: 600,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 200 }
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);

    function preload ()
    {
        this.load.image('caex', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_000.png');
        this.load.image('caexIdle01', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_001.png');
        this.load.image('caexIdle02', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_002.png');
        this.load.image('caexIdle03', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_003.png');
        this.load.image('caexIdle04', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_004.png');
        this.load.image('caexIdle05', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_005.png');
        this.load.image('caexIdle06', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_006.png');
        this.load.image('caexIdle07', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_007.png');
        this.load.image('caexIdle08', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_008.png');
        this.load.image('caexIdle09', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_009.png');
        this.load.image('caexIdle10', 'assets/Knights/SeperateImages/BlueKnight_entity_000_Idle_010.png');

        this.load.image('caexWalk00', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_000.png');
        this.load.image('caexWalk01', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_001.png');
        this.load.image('caexWalk02', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_002.png');
        this.load.image('caexWalk03', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_003.png');
        this.load.image('caexWalk04', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_004.png');
        this.load.image('caexWalk05', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_005.png');
        this.load.image('caexWalk06', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_006.png');
        this.load.image('caexWalk07', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_007.png');
        this.load.image('caexWalk08', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_008.png');
        this.load.image('caexWalk09', 'assets/Knights/SeperateImages/BlueKnight_entity_000_walk_009.png');

        this.load.image('epee01','assets/Swords/Epee1.png');
        this.load.image('epee02','assets/Swords/Epee2.png');
        this.load.image('epee03','assets/Swords/Epee3.png');
        this.load.image('epee04','assets/Swords/Epee4.png');
        this.load.image('epee05','assets/Swords/Epee5.png');
        this.load.image('epee06','assets/Swords/Epee6.png');
        
        this.load.image('sky', 'assets/sky.png');
        this.load.image('platform', 'assets/platform.png')
    }

    function create ()
    {
        this.add.image(400, 300, 'sky');

        platforms = this.physics.add.staticGroup();

        platforms.create(400, 568, 'platform').setScale(2).refreshBody();

        caex = this.physics.add.sprite(400,450, 'caex').setScale(0.2,0.2).refreshBody();

        caex.setCollideWorldBounds(true);

        this.physics.add.collider(caex, platforms);

        this.anims.create({
            key: 'idle',
            frames: [
                { key: 'caexIdle01', duration : 50},
                { key: 'caexIdle02', duration : 50},
                { key: 'caexIdle03', duration : 50},
                { key: 'caexIdle04', duration : 50},
                { key: 'caexIdle05', duration : 50},
                { key: 'caexIdle06', duration : 50},
                { key: 'caexIdle07', duration : 50},
                { key: 'caexIdle08', duration : 50},
                { key: 'caexIdle09', duration : 50},
                { key: 'caexIdle10', duration : 50}
            ],
            frameRate: 8,
            repeat: -1
        });

        this.anims.create({
            key: 'walk',
            frames: [
                { key: 'caexWalk00', duration : 50},
                { key: 'caexWalk01', duration : 50},
                { key: 'caexWalk02', duration : 50},
                { key: 'caexWalk03', duration : 50},
                { key: 'caexWalk04', duration : 50},
                { key: 'caexWalk05', duration : 50},
                { key: 'caexWalk06', duration : 50},
                { key: 'caexWalk07', duration : 50},
                { key: 'caexWalk08', duration : 50},
                { key: 'caexWalk09', duration : 50}
            ],
            frameRate: 8,
            repeat: -1
        });

        caex.anims.play('idle', true);

        cursors = this.input.keyboard.createCursorKeys();

        sword1 = this.physics.add.sprite(100,100, 'epee01').setScale(0.1).refreshBody();
        sword1.setFlip(false, true);
        this.physics.add.collider(sword1, platforms);
        this.physics.add.overlap(sword1, caex, telekineticSword.bind(this));
        sword2 = this.physics.add.sprite(200,100, 'epee02').setScale(0.1).refreshBody();
        sword2.setFlip(false, true);
        this.physics.add.collider(sword2, platforms);
        this.physics.add.overlap(sword2, caex, telekineticSword.bind(this));
        sword3 = this.physics.add.sprite(300,100, 'epee03').setScale(0.1).refreshBody();
        sword3.setFlip(false, true);
        this.physics.add.collider(sword3, platforms);
        this.physics.add.overlap(sword3, caex, telekineticSword.bind(this));
        sword4 = this.physics.add.sprite(500,100, 'epee04').setScale(0.04).refreshBody();
        sword4.setFlip(false, true);
        this.physics.add.collider(sword4, platforms);
        this.physics.add.overlap(sword4, caex, telekineticSword.bind(this));
        sword5 = this.physics.add.sprite(600,100, 'epee05').setScale(0.04).refreshBody();
        sword5.setFlip(false, true);
        this.physics.add.collider(sword5, platforms);
        this.physics.add.overlap(sword5, caex, telekineticSword.bind(this));
        sword6 = this.physics.add.sprite(700,100, 'epee06').setScale(0.04).refreshBody();
        sword6.setFlip(false, true);
        this.physics.add.collider(sword6, platforms);
        this.physics.add.overlap(sword6, caex, telekineticSword.bind(this));
    }

    function telekineticSword(epee)
    {
        console.log("Epee");
    }

    function update()
    {
        if (cursors.left.isDown)
        {
            caex.setVelocityX(-160);
            caex.anims.play('walk',true);
            console.log("left");
            caex.setFlip(false, false);
        }
        else if (cursors.right.isDown)
        {
            caex.setVelocityX(160);
            caex.anims.play('walk',true);
            console.log("right");
            caex.setFlip(true, false);
        }
        else
        {
            caex.setVelocityX(0);
            caex.anims.play('idle', true);
            console.log("idle");
        }
    }
    </script>

</body>
</html>